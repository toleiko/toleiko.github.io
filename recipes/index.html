<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>toleiko/recipes</title>
  <meta name="description" content="Cooking with Tori and Isaac - Delicious dishes and cooking adventures">
  <meta property="og:title" content="toleiko - recipes">
  <meta property="og:description" content="Cooking with Tori and Isaac - Delicious dishes and cooking adventures">
  <meta property="og:url" content="https://toleiko.ca/recipes">
  <meta property="og:type" content="website">
  <link rel="canonical" href="https://toleiko.ca/recipes">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <!-- Title Section Container -->
  <div id="titleSection"></div>
  
  <!-- Main Content -->
  <div class="content">
    <h2>Our Recipe Collection</h2>
    <p>Welcome to Isaac and Tori's kitchen! Here you'll find a collection of our favorite recipes, cooking experiments, and culinary adventures.</p>
    
    <!-- Recipe Categories -->
    <div class="recipe-categories">
      
      <!-- View All Recipes Button -->
      <div class="category-section" style="text-align: center; margin-bottom: 2rem;">
        <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
          <button onclick="showAllRecipes()" class="nav-button nav-button--secondary nav-button--large">
            ğŸ“– View All Recipes
          </button>
          <button onclick="showFundamentalRecipes()" class="nav-button nav-button--secondary nav-button--large">
            ğŸ“š Fundamental Recipes
          </button>
        </div>
      </div>
      
      <!-- Meals by Protein -->
      <div class="category-section">
        <h3>Meals by Protein</h3>
        <div id="proteinButtons"></div>
      </div>
      
      <!-- Meals by Type -->
      <div class="category-section">
        <h3>Meals by Type</h3>
        <div id="mealTypeButtons"></div>
      </div>
      
      <!-- Breakfast -->
      <div class="category-section">
        <h3>Breakfast</h3>
        <div id="breakfastButtons"></div>
      </div>
      
      <!-- Baking -->
      <div class="category-section">
        <h3>Baking</h3>
        <div id="bakingButtons"></div>
      </div>
      
      <!-- Holiday Themed -->
      <div class="category-section">
        <h3>Holiday Themed</h3>
        <div id="holidayButtons"></div>
      </div>
      
    </div>

    <!-- Filtered Results Section -->
    <div id="filteredResults" style="display: none;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2 id="filterTitle">Filtered Recipes</h2>
        <div style="display: flex; gap: 1rem;">
          <button onclick="showFundamentalRecipes()" class="nav-button nav-button--secondary nav-button--medium" style="display: none;">
            ğŸ“š Fundamental Recipes
          </button>
          <button onclick="showAllCategories()" class="nav-button nav-button--outline nav-button--medium">
            â† Back to Categories
          </button>
        </div>
      </div>
      <div id="recipeGrid" class="recipes-grid">
        <!-- Filtered recipes will be displayed here -->
      </div>
    </div>
    
  </div>

  <!-- Load Templates -->
  <script src="../js/templates.js"></script>
  <script>
    // Load the title section with custom data
    loadTemplate('titleSection', 'titleSection', {
      title: 'Recipes',
      searchPlaceholder: 'Search recipes...',
      showSearch: true,
      showDropdown: true,
      dropdownItems: [
        {
          text: 'Home',
          href: 'https://toleiko.ca',
          icon: 'ğŸ '
        },
        {
          text: 'Projects',
          href: 'https://toleiko.ca/projects',
          icon: 'ğŸš€'
        }
      ]
    });

    // Load recipe category buttons
    
    // Add event listeners after buttons are created
    setTimeout(() => {
      // Add click handlers to all category buttons
      const buttonCategories = [
        { selector: '#proteinButtons', tags: ['chicken', 'beef', 'pork', 'lamb', 'fish','vegetarian'] },
        { selector: '#mealTypeButtons', tags: ['pasta', 'rice', 'instant pot', 'salad', 'soup', 'sides'] },
        { selector: '#breakfastButtons', tags: ['savoury', 'sweet'] },
        { selector: '#bakingButtons', tags: ['cookies', 'bread', 'muffins', 'cake'] },
        { selector: '#holidayButtons', tags: ['christmas', 'passover', 'hanukkah', 'easter', 'thanksgiving'] }
      ];

      buttonCategories.forEach(category => {
        const buttons = document.querySelectorAll(`${category.selector} .nav-button`);
        buttons.forEach((button, index) => {
          button.addEventListener('click', (e) => {
            e.preventDefault();
            const tag = category.tags[index];
            console.log('Button clicked:', tag);
            filterRecipes(tag);
          });
        });
        console.log(`Event listeners added to ${buttons.length} buttons in ${category.selector}`);
      });
    }, 500);
    
    // Meals by Protein
    loadTemplate('buttonGroup', 'proteinButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Chicken', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ—', tag: 'chicken' },
        { text: 'Beef', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¥©', tag: 'beef' },
        { text: 'Pork', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ·', tag: 'pork' },
        { text: 'Lamb', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ‘', tag: 'lamb' },
        { text: 'Fish', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸŸ', tag: 'fish' },
        { text: 'Vegetarian', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¥¬', tag: 'vegetarian' }
      ]
    });

    // Meals by Type
    loadTemplate('buttonGroup', 'mealTypeButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Pasta', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ' },
        { text: 'Rice', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸš' },
        { text: 'Instant Pot', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¥˜' },
        { text: 'Salad', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¥—' },
        { text: 'Soup', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ²' },
        { text: 'Sides', href: '#', style: 'secondary', size: 'medium', icon: '' }
      ]
    });

    // Breakfast
    loadTemplate('buttonGroup', 'breakfastButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Savoury', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ³' },
        { text: 'Sweet', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¥' }
      ]
    });

    // Baking
    loadTemplate('buttonGroup', 'bakingButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Cookies', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸª' },
        { text: 'Bread', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ' },
        { text: 'Muffins', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ§' },
        { text: 'Cake', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ‚' }
      ]
    });

    // Holiday Themed
    loadTemplate('buttonGroup', 'holidayButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Passover', href: '#', style: 'secondary', size: 'medium', icon: '<img src="../assets/icons/passover_icon.png" alt="Passover" style="height:1.5em;width:1.5em;border-radius:0.3em;vertical-align:middle;object-fit:cover;">', tag: 'passover' },
        { text: 'Easter', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ°', tag: 'easter' },
        { text: 'Thanksgiving', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ¦ƒ', tag: 'thanksgiving' },
        { text: 'Hanukkah', href: '#', style: 'secondary', size: 'medium', icon: '<img src="../assets/icons/minora_icon.jpeg" alt="Hanukkah" style="height:1em;width:1em;border-radius:0.3em;vertical-align:middle;object-fit:cover;">', tag: 'hanukkah' },
        { text: 'Christmas', href: '#', style: 'secondary', size: 'medium', icon: 'ğŸ„', tag: 'christmas' }
      ]
    });

    // Recipe filtering functionality
    let allRecipes = [];

    // Load all recipes from the database folder
    async function loadRecipes() {
      const recipeFiles = [
        // A-C
        'annes-chicken.json',
        'beef-tenderloin.json',
        'boiled-eggs.json',
        'brussels-sprout-pasta.json',
        'cashew-chicken.json',
        'chicken-parmigiana.json',
        'chickpea-korma.json',
        'chana-masala.json',

        // D-F
        'french-onion-soup.json',

        // G-I
        'greek-lemon-potatoes.json',
        'instant-pot-indian-curry.json',
        'instant-pot-tuscan-chicken.json',
        'irish-beef-stew.json',

        // J-L
        'koogle.json',
        'lemon-orzo-chicken.json',
        'lemon-roast-chicken.json',

        // M-O
        'mac-n-cheese.json',
        'mexican-rice-bowl.json',

        // P-R
        'panaeng-curry.json',
        'peanut-satay-noodles.json',
        'popovers-stuffed.json',
        'popovers.json',
        'pork-tenderloin.json',
        'pumpkin-brussels-sprout-tart.json',
        'quinoa-power-salad.json',
        'rice-lentil-casserole.json',
        'risotto-and-meatballs.json',
        'roux.json',

        // S-U
        'salmon-marinade.json',
        'shepard-pie.json',
        'spiced-pilaf-beef-and-mushrooms.json',
        'spiced-pork-freekeh.json',
        'spicy-roasted-carrots.json',
        'spicy-mushroom-larb.json',
        'spring-rolls.json',
        'sticky-chicken.json',
        'teriyaki-chicken-lettuce-wraps.json',

        // V-Z
        'veggie-pesto-pasta.json'

      ];

      console.log('Loading recipes...');
      try {
        for (const file of recipeFiles) {
          console.log('Fetching:', `database/${file}`);
          try {
            const response = await fetch(`database/${file}`);
            console.log('Response for', file, ':', response.status, response.ok);
            
            if (response.ok) {
              const recipeText = await response.text();
              console.log('Raw response for', file, ':', recipeText.substring(0, 100));
              
              try {
                const recipe = JSON.parse(recipeText);
                console.log('Parsed recipe:', recipe.name, 'Tags:', recipe.tags);
                
                // Normalize ingredients format for consistency
                if (recipe.ingredients && typeof recipe.ingredients === 'object' && !Array.isArray(recipe.ingredients)) {
                  // Complex format - convert to simple format for filtering
                  recipe.ingredientSections = recipe.ingredients;
                  recipe.ingredients = Object.values(recipe.ingredients).flat();
                  console.log('Normalized complex ingredients for:', recipe.name);
                }
                
                allRecipes.push(recipe);
              } catch (parseError) {
                console.error('JSON parse error for', file, ':', parseError);
              }
            } else {
              console.error('Failed to fetch:', file, 'Status:', response.status, response.statusText);
            }
          } catch (fileError) {
            console.error('Error loading file', file, ':', fileError);
          }
        }
        console.log('All recipes loaded:', allRecipes.length);
        console.log('Recipe names:', allRecipes.map(r => r.name));
      } catch (error) {
        console.error('Error loading recipes:', error);
      }
    }

    // Filter recipes by tag
    function filterRecipes(tag) {
      console.log('Filtering recipes for tag:', tag);
      console.log('All recipes loaded:', allRecipes);
      
      const filteredRecipes = allRecipes.filter(recipe => 
        recipe.tags && recipe.tags.some(recipeTag => 
          recipeTag.toLowerCase().includes(tag.toLowerCase())
        )
      );

      console.log('Filtered recipes:', filteredRecipes);
      displayFilteredRecipes(filteredRecipes, tag);
    }

    // Display filtered recipes
    function displayFilteredRecipes(recipes, tag, showFundamentalButton = false) {
      const categoriesDiv = document.querySelector('.recipe-categories');
      const filteredDiv = document.getElementById('filteredResults');
      const filterTitle = document.getElementById('filterTitle');
      const recipeGrid = document.getElementById('recipeGrid');
      // const fundamentalBtn = document.getElementById('fundamentalRecipesBtn');

      // Hide categories, show filtered results
      categoriesDiv.style.display = 'none';
      filteredDiv.style.display = 'block';

      // // Show or hide the Fundamental Recipes button
      // if (fundamentalBtn) {
      //   fundamentalBtn.style.display = showFundamentalButton ? 'inline-block' : 'none';
      // }

      // Update title
      filterTitle.textContent = `${tag.charAt(0).toUpperCase() + tag.slice(1)} Recipes (${recipes.length})`;

      // Create recipe cards
      if (recipes.length === 0) {
        recipeGrid.innerHTML = '<p>No recipes found for this category.</p>';
      } else {
        recipeGrid.innerHTML = recipes.map(recipe => createRecipeCard(recipe)).join('');
      }

      // Scroll to top of page
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Create a recipe card HTML
    function createRecipeCard(recipe) {
      // Convert recipe name to filename format (lowercase, hyphens for spaces)
      const recipeFile = recipe.name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '').replace(/-+/g, '-');
      
      return `
        <div class="recipe-card clickable" onclick="openRecipe('${recipeFile}')">
          <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <div class="recipe-meta">
              <span class="prep-time">â±ï¸ ${recipe.duration} ${recipe.duration === 1 ? 'hour' : 'hours'}</span>
              <span class="servings">ğŸ½ï¸ ${recipe.servings} servings</span>
            </div>
            <div class="recipe-tags">
              ${recipe.tags ? recipe.tags.map(tag => `<span class="recipe-tag">${tag}</span>`).join('') : ''}
            </div>
          </div>
        </div>
      `;
    }

    // Open recipe detail page
    function openRecipe(recipeFile) {
      window.location.href = `recipe.html?recipe=${recipeFile}`;
    }

    // Show all categories (back button)
    function showAllCategories() {
      const categoriesDiv = document.querySelector('.recipe-categories');
      const filteredDiv = document.getElementById('filteredResults');

      categoriesDiv.style.display = 'block';
      filteredDiv.style.display = 'none';

      // Scroll to top of page
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Test function to verify buttons work
    window.testClick = function() {
      alert('Button click detected!');
    };

    // Show all recipes in alphabetical order
    function showAllRecipes() {
      // Sort recipes alphabetically by name
      const sortedRecipes = [...allRecipes].sort((a, b) => 
        a.name.localeCompare(b.name)
      );
      
      displayFilteredRecipes(sortedRecipes, 'All Recipes', true);
    }

    // Show fundamental recipes (recipes tagged as fundamental)
    function showFundamentalRecipes() {
      // Filter recipes that have the "fundamental" tag
      const fundamentalRecipes = allRecipes.filter(recipe => 
        recipe.tags && recipe.tags.some(tag => 
          tag.toLowerCase() === 'fundamental'
        )
      );
      
      // Sort alphabetically
      const sortedRecipes = fundamentalRecipes.sort((a, b) => 
        a.name.localeCompare(b.name)
      );
      
      displayFilteredRecipes(sortedRecipes, 'Fundamental Recipes', false);
    }

    // Make functions globally accessible
    window.filterRecipes = filterRecipes;
    window.showAllCategories = showAllCategories;
    window.showAllRecipes = showAllRecipes;
    window.showFundamentalRecipes = showFundamentalRecipes;
    window.openRecipe = openRecipe;

    // Load recipes when page loads
    loadRecipes().then(() => {
      console.log('Recipes loaded successfully:', allRecipes.length, 'recipes');
    });

  </script>
</body>
</html>
