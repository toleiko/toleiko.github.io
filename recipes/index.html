<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>toleiko/recipes</title>
  <meta name="description" content="Cooking with Tori and Isaac - Delicious dishes and cooking adventures">
  <meta property="og:title" content="toleiko - recipes">
  <meta property="og:description" content="Cooking with Tori and Isaac - Delicious dishes and cooking adventures">
  <meta property="og:url" content="https://toleiko.ca/recipes">
  <meta property="og:type" content="website">
  <link rel="canonical" href="https://toleiko.ca/recipes">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <!-- Title Section Container -->
  <div id="titleSection"></div>
  
  <!-- Main Content -->
  <div class="content">
    <h2>Our Recipe Collection</h2>
    <p>Welcome to Isaac and Tori's kitchen! Here you'll find a collection of our favorite recipes, cooking experiments, and culinary adventures.</p>
    
    <!-- Recipe Categories -->
    <div class="recipe-categories">
      
      <!-- Meals by Protein -->
      <div class="category-section">
        <h3>Meals by Protein</h3>
        <div id="proteinButtons"></div>
      </div>
      
      <!-- Meals by Type -->
      <div class="category-section">
        <h3>Meals by Type</h3>
        <div id="mealTypeButtons"></div>
      </div>
      
      <!-- Breakfast -->
      <div class="category-section">
        <h3>Breakfast</h3>
        <div id="breakfastButtons"></div>
      </div>
      
      <!-- Desserts -->
      <div class="category-section">
        <h3>Desserts</h3>
        <div id="dessertButtons"></div>
      </div>
      
      <!-- Holiday Themed -->
      <div class="category-section">
        <h3>Holiday Themed</h3>
        <div id="holidayButtons"></div>
      </div>
      
    </div>

    <!-- Filtered Results Section -->
    <div id="filteredResults" style="display: none;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2 id="filterTitle">Filtered Recipes</h2>
        <button onclick="showAllCategories()" class="nav-button nav-button--outline nav-button--medium">
          ‚Üê Back to Categories
        </button>
      </div>
      <div id="recipeGrid" class="recipes-grid">
        <!-- Filtered recipes will be displayed here -->
      </div>
    </div>
    
  </div>

  <!-- Load Templates -->
  <script src="../js/templates.js"></script>
  <script>
    // Load the title section with custom data
    loadTemplate('titleSection', 'titleSection', {
      title: 'Recipes',
      searchPlaceholder: 'Search recipes...',
      showSearch: true,
      showDropdown: true,
      dropdownItems: [
        {
          text: 'Home',
          href: 'https://toleiko.ca',
          icon: 'üè†'
        },
        {
          text: 'Projects',
          href: 'https://toleiko.ca/projects',
          icon: 'üöÄ'
        }
      ]
    });

    // Load recipe category buttons
    
    // Add event listeners after buttons are created
    setTimeout(() => {
      // Add click handlers to protein buttons
      const proteinButtons = document.querySelectorAll('#proteinButtons .nav-button');
      const tags = ['chicken', 'beef', 'pork', 'lamb', 'vegetarian'];
      
      proteinButtons.forEach((button, index) => {
        button.addEventListener('click', (e) => {
          e.preventDefault();
          console.log('Button clicked:', tags[index]);
          filterRecipes(tags[index]);
        });
      });

      console.log('Event listeners added to', proteinButtons.length, 'buttons');
    }, 500);
    
    // Meals by Protein
    loadTemplate('buttonGroup', 'proteinButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Chicken', href: '#', style: 'secondary', size: 'medium', icon: 'üçó', tag: 'chicken' },
        { text: 'Beef', href: '#', style: 'secondary', size: 'medium', icon: 'ü•©', tag: 'beef' },
        { text: 'Pork', href: '#', style: 'secondary', size: 'medium', icon: 'üê∑', tag: 'pork' },
        { text: 'Lamb', href: '#', style: 'secondary', size: 'medium', icon: 'üêë', tag: 'lamb' },
        { text: 'Vegetarian', href: '#', style: 'secondary', size: 'medium', icon: 'ü•¨', tag: 'vegetarian' }
      ]
    });

    // Meals by Type
    loadTemplate('buttonGroup', 'mealTypeButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Pasta', href: '#', style: 'secondary', size: 'medium', icon: 'üçù' },
        { text: 'Rice', href: '#', style: 'secondary', size: 'medium', icon: 'üçö' },
        { text: 'Instant Pot', href: '#', style: 'secondary', size: 'medium', icon: 'ü•ò' },
        { text: 'Soup', href: '#', style: 'secondary', size: 'medium', icon: 'üç≤' },
        { text: 'Sides', href: '#', style: 'secondary', size: 'medium', icon: 'ü•ó' }
      ]
    });

    // Breakfast
    loadTemplate('buttonGroup', 'breakfastButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Savoury', href: '#', onclick: 'filterRecipes("savoury")', style: 'secondary', size: 'medium', icon: 'üç≥' },
        { text: 'Sweet', href: '#', onclick: 'filterRecipes("sweet")', style: 'secondary', size: 'medium', icon: 'ü•û' }
      ]
    });

    // Desserts
    loadTemplate('buttonGroup', 'dessertButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Cookies', href: '#', onclick: 'filterRecipes("cookies")', style: 'secondary', size: 'medium', icon: 'üç™' },
        { text: 'Bread', href: '#', onclick: 'filterRecipes("bread")', style: 'secondary', size: 'medium', icon: 'üçû' },
        { text: 'Muffins', href: '#', onclick: 'filterRecipes("muffins")', style: 'secondary', size: 'medium', icon: 'üßÅ' },
        { text: 'Cake', href: '#', onclick: 'filterRecipes("cake")', style: 'secondary', size: 'medium', icon: 'üéÇ' }
      ]
    });

    // Holiday Themed
    loadTemplate('buttonGroup', 'holidayButtons', {
      alignment: 'left',
      spacing: 'normal',
      buttons: [
        { text: 'Christmas', href: '#', onclick: 'filterRecipes("christmas")', style: 'secondary', size: 'medium', icon: 'üéÑ' },
        { text: 'Passover', href: '#', onclick: 'filterRecipes("passover")', style: 'secondary', size: 'medium', icon: '‚ú°Ô∏è' },
        { text: 'Chanukah', href: '#', onclick: 'filterRecipes("chanukah")', style: 'secondary', size: 'medium', icon: 'üïé' },
        { text: 'Easter', href: '#', onclick: 'filterRecipes("easter")', style: 'secondary', size: 'medium', icon: 'üê∞' },
        { text: 'Thanksgiving', href: '#', onclick: 'filterRecipes("thanksgiving")', style: 'secondary', size: 'medium', icon: 'ü¶É' }
      ]
    });

    // Recipe filtering functionality
    let allRecipes = [];

    // Load all recipes from the database
    async function loadRecipes() {
      const recipeFiles = [
        'panang-curry.json',
        'sticky-chicken.json',
        'teriyaki-chicken-lettuce-wraps.json'
      ];

      console.log('Loading recipes...');
      try {
        for (const file of recipeFiles) {
          console.log('Fetching:', `database/${file}`);
          const response = await fetch(`database/${file}`);
          if (response.ok) {
            const recipe = await response.json();
            console.log('Loaded recipe:', recipe.name);
            allRecipes.push(recipe);
          } else {
            console.error('Failed to fetch:', file, response.status);
          }
        }
        console.log('All recipes loaded:', allRecipes.length);
      } catch (error) {
        console.error('Error loading recipes:', error);
      }
    }

    // Filter recipes by tag
    function filterRecipes(tag) {
      console.log('Filtering recipes for tag:', tag);
      console.log('All recipes loaded:', allRecipes);
      
      const filteredRecipes = allRecipes.filter(recipe => 
        recipe.tags && recipe.tags.some(recipeTag => 
          recipeTag.toLowerCase().includes(tag.toLowerCase())
        )
      );

      console.log('Filtered recipes:', filteredRecipes);
      displayFilteredRecipes(filteredRecipes, tag);
    }

    // Display filtered recipes
    function displayFilteredRecipes(recipes, tag) {
      const categoriesDiv = document.querySelector('.recipe-categories');
      const filteredDiv = document.getElementById('filteredResults');
      const filterTitle = document.getElementById('filterTitle');
      const recipeGrid = document.getElementById('recipeGrid');

      // Hide categories, show filtered results
      categoriesDiv.style.display = 'none';
      filteredDiv.style.display = 'block';

      // Update title
      filterTitle.textContent = `${tag.charAt(0).toUpperCase() + tag.slice(1)} Recipes (${recipes.length})`;

      // Create recipe cards
      if (recipes.length === 0) {
        recipeGrid.innerHTML = '<p>No recipes found for this category.</p>';
      } else {
        recipeGrid.innerHTML = recipes.map(recipe => createRecipeCard(recipe)).join('');
      }
    }

    // Create a recipe card HTML
    function createRecipeCard(recipe) {
      return `
        <div class="recipe-card">
          <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <div class="recipe-meta">
              <span class="prep-time">‚è±Ô∏è ${recipe.duration} ${recipe.duration === 1 ? 'hour' : 'hours'}</span>
              <span class="servings">üçΩÔ∏è ${recipe.servings} servings</span>
            </div>
            <div class="recipe-tags">
              ${recipe.tags ? recipe.tags.map(tag => `<span class="recipe-tag">${tag}</span>`).join('') : ''}
            </div>
          </div>
        </div>
      `;
    }

    // Show all categories (back button)
    function showAllCategories() {
      const categoriesDiv = document.querySelector('.recipe-categories');
      const filteredDiv = document.getElementById('filteredResults');

      categoriesDiv.style.display = 'block';
      filteredDiv.style.display = 'none';
    }

    // Test function to verify buttons work
    window.testClick = function() {
      alert('Button click detected!');
    };

    // Make functions globally accessible
    window.filterRecipes = filterRecipes;
    window.showAllCategories = showAllCategories;

    // Load recipes when page loads
    loadRecipes().then(() => {
      console.log('Recipes loaded successfully:', allRecipes.length, 'recipes');
    });

  </script>
</body>
</html>
